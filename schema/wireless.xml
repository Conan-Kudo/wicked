<!--
  -- Wireless Service definition
  -->
<service name="wireless" interface="org.opensuse.Network.Wireless" object-class="netif-wireless">
  <define name="network_t" class="dict">
    <essid type="string"/>
    <access-point type="ethernet-address"/>

    <mode type="builtin-wireless-mode"/>
    <channel type="uint32"/>
    <frequency type="double"/>

    <auth-info class="dict">
      <mode type="builtin-wireless-auth"/>
      <version type="uint32"/>
      <group-cipher type="builtin-wireless-cipher"/>
      <pairwise-ciphers type="builtin-wireless-cipher-mask"/>
      <key-management type="builtin-key-mgmt-mask"/>
    </auth-info>
  </define>

  <define name="properties" class="dict">
    <scan class="dict">
      <!-- zero or more networks found during last scan -->
      <network type="network_t"/>
    </scan>

    <eap-methods type="builtin-eap-method-mask"/>
    <pairwise-ciphers type="builtin-wireless-cipher-mask"/>
    <group-ciphers type="builtin-wireless-cipher-mask"/>
    <key-management type="builtin-key-mgmt-mask"/>
    <auth-methods type="builtin-wireless-auth-mask"/>
    <!-- <wpa-protocols type="builtin-wireless-protocol-mask"/> -->
  </define>

  <define name="link-request" class="dict">
    <description>
     This type contains the requested wireless link configuration.
    </description>

    <essid type="string" description="SSID of the network to connect to"/>
    <mode type="builtin-wireless-mode"/>
    <access-point type="ethernet-address" description="Address of AP to connect to"/>

    <wpa-psk class="dict" constraint="exclusive:wpa-auth-data">
      <passphrase type="string" constraint="required">
        <meta:user-input type="password" prompt="please enter WPA PSK passphrase"/>
      </passphrase>
      <key class="array" element-type="byte" minlen="64" maxlen="64" notation="hwaddr"/>
    </wpa-psk>

    <wpa-eap class="dict" constraint="exclusive:wpa-auth-data">
      <method type="builtin-eap-method" constraint="required"/>

      <identity type="string" constraint="required">
        <meta:user-input type="username" prompt="please enter WPA EAP identity"/>
      </identity>

      <phase2 class="dict">
	<description>
	  When using eg TTLS with a secondary authentication step, it can be
	  configured here.
	</description>

	<!-- Mark the following elements as required. Which means if
	     the <phase2> element exists, we require these two child
	     elements to be there, too. -->
        <method type="builtin-eap-method" constraint="required"/>
        <password type="string" constraint="required">
          <meta:user-input type="password" prompt="please enter WPA EAP password"/>
        </password>
      </phase2>

      <tls class="dict">
        <ca-cert type="external-file" description="For TLS based methods, this can be used to specify a CA certificate"/>
      </tls>
    </wpa-eap>
  </define>

  <method name="changeDevice">
    <arguments>
      <config type="link-request">
       <meta:mapping document-node="/wireless" skip-unless-present="true" />
      </config>
    </arguments>
  </method>

  <method name="setScanning">
    <arguments>
      <enable type="boolean"/>
    </arguments>
  </method>
</service>


