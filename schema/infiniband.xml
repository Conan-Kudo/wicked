<!--
     Infiniband Service definition
  -->
<service name="infiniband" interface="org.opensuse.Network.Infiniband" object-class="netif-infiniband">
      
  <define name="configuration" class="dict" description="Infiniband interface configuration">

    <mode type="uint32" constraint="enum">
      <connected value="0"/>
      <datagram value="1"/>
    </mode>

    <multicast type="uint32" constraint="enum">
      <disallow value="0" />
      <allow value="1" />
    </multicast>

  </define>

  <define name="properties" class="dict" extends="infiniband:configuration">

    <!-- read-only on ib-parent -->
    <pkey type="uint16" description="Infiniband partition key"/>

  </define>

  <method name="changeDevice">
    <arguments>
      <config type="infiniband:configuration">
        <meta:mapping document-node="/infiniband" />
      </config>
    </arguments>
  </method>
</service>

<service name="infiniband-child" interface="org.opensuse.Network.InfinibandChild" object-class="netif-infiniband-child">

  <define name="configuration"  class="dict" extends="infiniband:configuration"
          description="Infiniband child interface configuration">

    <parent type="string" description="Infiniband parent interface reference">
      <meta:netif-reference shared="true"/>
      <!-- meta:require check="netif-child-state" op="newDevice" min-state="device-exists" / -->
    </parent>

    <pkey type="uint16" description="Infiniband partition key"/>

  </define>

  <define name="properties" type="infiniband-child:configuration">
    <!-- Add more info properties here -->
  </define>

  <method name="changeDevice">
    <arguments>
      <config type="infiniband-child:configuration">
        <meta:mapping document-node="/infiniband-child" />
      </config>
    </arguments>
  </method>

  <method name="deleteDevice" />
</service>

<service name="infiniband-child-factory" interface="org.opensuse.Network.InfinibandChild.Factory" object-class="netif-list">

  <method name="newDevice">
    <arguments>
      <name type="string"/>
      <config type="infiniband-child:configuration">
        <meta:mapping document-node="/infiniband-child"/>
      </config>
    </arguments>
    <return>
      <!-- this is really an object handle -->
      <string/>
    </return>
  </method>
</service>
